<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>横版跳跃</title>
    <link rel="stylesheet" href="css/main.css" type="text/css">
    <script src="js/jquery.js"></script>
</head>

<body>

    <div class="kbBox" id="kbBox"></div>

    <div class="startGame" id="startGame">
        made by zhyDaDa<br> 按空格键开始游戏
    </div>

    <div class="gameId" id="gameId" style="display: none;">
        <div id="tipBoard">
            <h6 id="h6_1">
                <form action="javascript:void(0);" id="addressForm">
                    <input type="text" name="joinServerIP" id="joinServerIP" placeholder="输入服务器地址" />
                    <input type="submit" value="加入" />
                </form>
            </h6>
            <h6 id="h6_2">
                <span>当前服务器地址: <span id="currentServerIP" style="color:blueviolet">null</span></span>
            </h6>
            <h6 id="h6_3">尚未连接服务器</h6>
            <h6 id="h6_4">服务器信号延迟: &nbsp;<span style="color: darkgreen;" id="serverDelay">null</span>&nbsp;ms</h6>
            <h6 id="h6_4">客户端渲染延迟: &nbsp;<span style="color: darkblue;" id="renderDelay">null</span>&nbsp;ms</h6>
            <hr style="margin:1rem 0;">
            <h6 id="h6_5">输入皮肤颜色: &nbsp;
                <form action="javascript:void(0);" id="setSkinColor">
                    <input type="text" name="skinColor" id="skinColor" placeholder="带#的十六进制或英文" />
                    <input type="submit" value="设置" />
                </form>
            </h6>
            <h6 id="h6_5">输入玩家名称: &nbsp;
                <form action="javascript:void(0);" id="setPlayerName">
                    <input type="text" name="setPlayerName" id="setPlayerName" placeholder=`字数不能超过${nameMaxLength}字` />
                    <input type="submit" value="设置" />
                </form>
            </h6>
            <h6 id="h6_6">视图缩放倍率: &nbsp;<input id="viewScale" type="range" min="0.2" max="2" step="0.01" value="0.9" style="width: 50%;" tabindex="-1" /></h6>
        </div>
        <canvas id="canvas" style="width: 100vw;height: 100vh;"></canvas>


    </div>
    <script src="js/map.js"></script>
    <script src="js/client.js"></script>
    <script>
        window.onload = function() {

            $('#addressForm').on('submit', function(e) {
                e.preventDefault();
                let data = document.querySelector('#addressForm').joinServerIP.value;
                setServer(data);
            });
            $('#setSkinColor').on('submit', function(e) {
                e.preventDefault();
                let data = document.querySelector('#setSkinColor').skinColor.value;
                setSkinColor(data);
            });
            $('#setPlayerName').on('submit', function(e) {
                e.preventDefault();
                let data = document.querySelector('#setPlayerName').setPlayerName.value;
                setPlayerName(data);
            });
            $('#viewScale').on('change', function(e) {
                let data = document.querySelector('#viewScale').value;
                zoomIndex = data;
                setViewZoom(data);
            });
            window.onresize = function() {
                setViewZoom(zoomIndex);
            };

            // 链接 432 ws
            setServer(localStorage.getItem("lastServerAddress"));
            var startGameId = document.getElementById("startGame");
            var enterGameId = document.getElementById("enterGame");
            var gameId = document.getElementById("gameId");
            gameId.setAttribute("style", "display:block");
            startGameId.setAttribute("style", "display:none");
        }
    </script>
</body>

</html>